{"ast":null,"code":"import _defineProperty from \"/home/ashitosh/mineapp/mine3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _objectSpread from \"/home/ashitosh/mineapp/mine3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _regeneratorRuntime from \"/home/ashitosh/mineapp/mine3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/home/ashitosh/mineapp/mine3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/home/ashitosh/mineapp/mine3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/ashitosh/mineapp/mine3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/ashitosh/mineapp/mine3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/ashitosh/mineapp/mine3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/ashitosh/mineapp/mine3/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/home/ashitosh/mineapp/mine3/src/components/login.js\";\nimport React, { Component, Fragment } from \"react\";\nimport fire from \"./../config/firebase\";\nimport Spinner from \"../UI/Spinner\";\nimport { Link } from \"react-router-dom\";\nimport Input from \"../UI/Input/Input\";\nimport Validator from \"validatorjs\";\n\nvar Login =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Login, _Component);\n\n  function Login(props) {\n    var _this;\n\n    _classCallCheck(this, Login);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Login).call(this, props));\n\n    _this.onSubmitLogin = function (e) {\n      e.preventDefault();\n\n      _this.setState({\n        loading: true\n      });\n\n      if (!_this.state.orderForm.email.value || !_this.state.orderForm.password.value) {\n        return _this.setState({\n          error: {\n            message: \"Please enter required details\"\n          },\n          loading: false\n        });\n      }\n\n      _this.loginAction();\n    };\n\n    _this.loginAction =\n    /*#__PURE__*/\n    _asyncToGenerator(\n    /*#__PURE__*/\n    _regeneratorRuntime.mark(function _callee() {\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.prev = 0;\n              _context.next = 3;\n              return _this.validateCredentials();\n\n            case 3:\n              _context.next = 5;\n              return _this.successfullLogin();\n\n            case 5:\n              _context.next = 10;\n              break;\n\n            case 7:\n              _context.prev = 7;\n              _context.t0 = _context[\"catch\"](0);\n\n              _this.setState({\n                error: _context.t0,\n                loading: false\n              });\n\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[0, 7]]);\n    }));\n\n    _this.inputChangedHandler = function (event, inputIdentifier) {\n      var updatedOrderForm = _objectSpread({}, _this.state.orderForm);\n\n      var updatedFormElement = _objectSpread({}, updatedOrderForm[inputIdentifier]);\n\n      updatedFormElement.value = event.target.value;\n      var validation = new Validator(_defineProperty({}, inputIdentifier, updatedFormElement.value), _defineProperty({}, inputIdentifier, updatedFormElement.rule));\n\n      if (!validation.passes()) {\n        updatedFormElement.error = validation.errors.first(inputIdentifier);\n      } else {\n        updatedFormElement.error = \"\";\n      }\n\n      updatedOrderForm[inputIdentifier] = updatedFormElement;\n\n      _this.setState({\n        orderForm: updatedOrderForm\n      });\n    };\n\n    _this.state = {\n      error: \"\",\n      loading: false,\n      orderForm: {\n        email: {\n          elementType: \"input\",\n          elementConfig: {\n            type: \"email\",\n            name: \"email\",\n            placeholder: \"Username\"\n          },\n          value: \"\",\n          rule: \"required|email\",\n          error: \"\"\n        },\n        password: {\n          elementType: \"input\",\n          elementConfig: {\n            type: \"password\",\n            name: \"password\",\n            placeholder: \"Password\"\n          },\n          value: \"\",\n          rule: \"required\",\n          error: \"\"\n        }\n      }\n    };\n    return _this;\n  }\n\n  _createClass(Login, [{\n    key: \"componentWillMount\",\n    value: function componentWillMount() {\n      this.setState({\n        loading: true\n      });\n    }\n  }, {\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.setState({\n        loading: false\n      });\n    }\n  }, {\n    key: \"validateCredentials\",\n    value: function validateCredentials() {\n      return fire.auth().signInWithEmailAndPassword(this.state.orderForm.email.value, this.state.orderForm.password.value);\n    }\n  }, {\n    key: \"successfullLogin\",\n    value: function successfullLogin() {\n      localStorage.setItem(\"authUser\", this.state.orderForm.email.value);\n      this.setState({\n        loading: false\n      });\n      this.props.history.push(\"/\");\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var formElementsArray = [];\n\n      for (var key in this.state.orderForm) {\n        formElementsArray.push({\n          id: key,\n          config: this.state.orderForm[key]\n        });\n      }\n\n      var _this$state = this.state,\n          error = _this$state.error,\n          loading = _this$state.loading;\n      var loginPage = React.createElement(\"form\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }, React.createElement(\"h3\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }, React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139\n        },\n        __self: this\n      }, \"Login Page\")), error ? React.createElement(\"div\", {\n        class: \"alert alert-danger\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }, React.createElement(\"strong\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      }, \"Alert!\"), \" \", error.message, \".\") : null, formElementsArray.map(function (formElement) {\n        return React.createElement(Input, {\n          key: formElement.id,\n          label: formElement.id,\n          elementType: formElement.config.elementType,\n          elementConfig: formElement.config.elementConfig,\n          value: formElement.config.value,\n          error: formElement.config.error,\n          changed: function changed(event) {\n            return _this2.inputChangedHandler(event, formElement.id);\n          },\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 147\n          },\n          __self: this\n        });\n      }), React.createElement(\"button\", {\n        className: \"btn btn-success\",\n        onClick: this.onSubmitLogin,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 157\n        },\n        __self: this\n      }, \"Login\"), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 160\n        },\n        __self: this\n      }), \"or \", React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      }), \"Do\", React.createElement(Link, {\n        to: \"/register\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 163\n        },\n        __self: this\n      }, \" Register \"), \"here.\");\n\n      if (loading) {\n        loginPage = React.createElement(Spinner, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 169\n          },\n          __self: this\n        });\n      }\n\n      return React.createElement(Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 172\n        },\n        __self: this\n      }, loginPage);\n    }\n  }]);\n\n  return Login;\n}(Component);\n\nexport default Login;","map":{"version":3,"sources":["/home/ashitosh/mineapp/mine3/src/components/login.js"],"names":["React","Component","Fragment","fire","Spinner","Link","Input","Validator","Login","props","onSubmitLogin","e","preventDefault","setState","loading","state","orderForm","email","value","password","error","message","loginAction","validateCredentials","successfullLogin","inputChangedHandler","event","inputIdentifier","updatedOrderForm","updatedFormElement","target","validation","rule","passes","errors","first","elementType","elementConfig","type","name","placeholder","auth","signInWithEmailAndPassword","localStorage","setItem","history","push","formElementsArray","key","id","config","loginPage","map","formElement"],"mappings":"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","sourcesContent":["import React, { Component, Fragment } from \"react\";\nimport fire from \"./../config/firebase\";\nimport Spinner from \"../UI/Spinner\";\nimport { Link } from \"react-router-dom\";\nimport Input from \"../UI/Input/Input\";\nimport Validator from \"validatorjs\";\n\nclass Login extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      error: \"\",\n      loading: false,\n      orderForm: {\n        email: {\n          elementType: \"input\",\n          elementConfig: {\n            type: \"email\",\n            name: \"email\",\n            placeholder: \"Username\"\n          },\n          value: \"\",\n          rule: \"required|email\",\n          error: \"\"\n        },\n        password: {\n          elementType: \"input\",\n          elementConfig: {\n            type: \"password\",\n            name: \"password\",\n            placeholder: \"Password\"\n          },\n          value: \"\",\n          rule: \"required\",\n          error: \"\"\n        }\n      }\n    };\n  }\n\n  onSubmitLogin = e => {\n    e.preventDefault();\n\n    this.setState({\n      loading: true\n    });\n\n    if (\n      !this.state.orderForm.email.value ||\n      !this.state.orderForm.password.value\n    ) {\n      return this.setState({\n        error: { message: \"Please enter required details\" },\n        loading: false\n      });\n    }\n\n    this.loginAction();\n  };\n\n  componentWillMount() {\n    this.setState({\n      loading: true\n    });\n  }\n  componentDidMount() {\n    this.setState({\n      loading: false\n    });\n  }\n\n  validateCredentials() {\n    return fire\n      .auth()\n      .signInWithEmailAndPassword(\n        this.state.orderForm.email.value,\n        this.state.orderForm.password.value\n      );\n  }\n  successfullLogin() {\n    localStorage.setItem(\"authUser\", this.state.orderForm.email.value);\n    this.setState({\n      loading: false\n    });\n\n    this.props.history.push(\"/\");\n  }\n\n  loginAction = async () => {\n    try {\n      await this.validateCredentials();\n      await this.successfullLogin();\n    } catch (e) {\n      this.setState({\n        error: e,\n        loading: false\n      });\n    }\n  };\n\n  inputChangedHandler = (event, inputIdentifier) => {\n    const updatedOrderForm = {\n      ...this.state.orderForm\n    };\n\n    const updatedFormElement = {\n      ...updatedOrderForm[inputIdentifier]\n    };\n    updatedFormElement.value = event.target.value;\n\n    let validation = new Validator(\n      { [inputIdentifier]: updatedFormElement.value },\n      { [inputIdentifier]: updatedFormElement.rule }\n    );\n\n    if (!validation.passes()) {\n      updatedFormElement.error = validation.errors.first(inputIdentifier);\n    } else {\n      updatedFormElement.error = \"\";\n    }\n\n    updatedOrderForm[inputIdentifier] = updatedFormElement;\n    this.setState({ orderForm: updatedOrderForm });\n  };\n\n  render() {\n    const formElementsArray = [];\n    for (let key in this.state.orderForm) {\n      formElementsArray.push({\n        id: key,\n        config: this.state.orderForm[key]\n      });\n    }\n    const { error, loading } = this.state;\n\n    let loginPage = (\n      <form>\n        <h3>\n          <strong>Login Page</strong>\n        </h3>\n        {error ? (\n          <div class=\"alert alert-danger\">\n            <strong>Alert!</strong> {error.message}.\n          </div>\n        ) : null}\n        {formElementsArray.map(formElement => (\n          <Input\n            key={formElement.id}\n            label={formElement.id}\n            elementType={formElement.config.elementType}\n            elementConfig={formElement.config.elementConfig}\n            value={formElement.config.value}\n            error={formElement.config.error}\n            changed={event => this.inputChangedHandler(event, formElement.id)}\n          />\n        ))}\n        <button className=\"btn btn-success\" onClick={this.onSubmitLogin}>\n          Login\n        </button>\n        <br />\n        or <br />\n        Do\n        <Link to={\"/register\"}> Register </Link>\n        here.\n      </form>\n    );\n\n    if (loading) {\n      loginPage = <Spinner />;\n    }\n\n    return <Fragment>{loginPage}</Fragment>;\n  }\n}\n\nexport default Login;\n"]},"metadata":{},"sourceType":"module"}